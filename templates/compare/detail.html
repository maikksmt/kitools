{% extends "base.html" %} {% load i18n %} {% block meta_title %}<title>
    {{ object.title }} ‚Äì {{ SITE_NAME }}</title
>{% endblock %} {% block meta_description %}
    <meta
            name="description"
            content="{{ object.summary|default:_('Vergleich von KI-Tools nach Kriterien.') }}"
    />
{% endblock %} {% block og_type %}article{% endblock %} {% block meta_jsonld %}
    <script type="application/ld+json">
        {
          "@context":"https://schema.org",
          "@type":"ItemList",
          "name":"{{ object.title|escapejs }}",
    "itemListElement":[
        {% for t in object.tools.all %}
            {"@type":"ListItem","position":{{ forloop.counter }},"url":"
            {{ SITE_URL }}{% url 'catalog:tool_detail' slug=t.slug %}"}{% if not forloop.last %},{% endif %}
      {% endfor %}
        ],
        "url":"{{ request.build_absolute_uri }}"
  }
    </script>
{% endblock %} {% block title %}{{ object.title }}{% endblock %} {% block content %}
    {% include "partials/breadcrumbs.html" %}

    <article class="prose max-w-none">
        <header class="mb-6">
            <h1 class="text-3xl font-bold">{{ object.title }}</h1>
            {% if object.summary %}
                <p class="text-base-content/80 mt-2">{{ object.summary }}</p>
            {% endif %} {% if object.winner %}
            <div class="mt-3 alert alert-success">
      <span
      >üèÜ {% trans "Gewinner" %}:
        <strong>{{ object.winner.name }}</strong></span
      >
            </div>
        {% endif %}
            <div class="mt-2 flex flex-wrap gap-2">
                {% if object.tools.all %} {% for t in object.tools.all %}
                    <a
                            href="{% url 'catalog:tool_detail' slug=t.slug %}"
                            class="badge badge-outline"
                    >{{ t.name }}</a
                    >
                {% endfor %} {% endif %}
            </div>
        </header>

        {% if object.score_breakdown %}
            <section class="mb-8">
                <h2 class="text-2xl font-semibold">
                    {% trans "Bewertung nach Kriterien" %}
                </h2>
                <div class="overflow-x-auto">
                    <table class="table">
                        <thead>
                        <tr>
                            <th>{% trans "Kriterium" %}</th>
                            {% for t in object.tools.all %}
                                <th>{{ t.name }}</th>
                            {% endfor %}
                        </tr>
                        </thead>
                        <tbody>
                        {# score_breakdown erwartet Struktur: { "Preis": {"ToolA": 8, "ToolB": 7}, "Qualit√§t": {...} } #}
                        {% for criterion, scores in object.score_breakdown.items %}
                            <tr>
                                <th class="whitespace-nowrap">{{ criterion }}</th>
                                {% for t in object.tools.all %}
                                    <td>
                                        {% if scores.t|get:t.name %} {{ scores|get:t.name }} {% else %}
                                            {{ scores.t|get:t.slug|default:"‚Äì" }} {% endif %}
                                    </td>
                                {% endfor %}
                            </tr>
                        {% endfor %}
                        </tbody>
                    </table>
                </div>
            </section>
        {% endif %} {% if object.notes %}
        <section class="mb-8">
            <h2 class="text-2xl font-semibold">{% trans "Anmerkungen" %}</h2>
            <div>{{ object.notes|safe }}</div>
        </section>
    {% endif %}
    </article>

    {% if related_comparisons %}
        <section class="mt-10">
            <h2 class="text-2xl font-semibold mb-4">{% trans "√Ñhnliche Vergleiche" %}</h2>
            <div class="grid gap-6 md:grid-cols-2 lg:grid-cols-3">
                {% for c in related_comparisons %}
                    <article class="card bg-base-100 shadow">
                        <div class="card-body">
                            <h3 class="card-title text-base">
                                <a
                                        href="{% url 'compare:detail' slug=c.slug %}"
                                        class="link link-hover"
                                >{{ c.title }}</a
                                >
                            </h3>
                            {% if c.intro %}
                                <p class="text-sm text-base-content/70 line-clamp-3">{{ c.intro }}</p>
                            {% endif %}
                        </div>
                    </article>
                {% endfor %}
            </div>
        </section>
    {% endif %} {% endblock %}
